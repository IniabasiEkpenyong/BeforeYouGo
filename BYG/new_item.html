<div id="addNewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div id="modContent" class="bg-white rounded-lg shadow-xl w-full max-w-xl overflow-hidden">
      <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
        <h3 class="text-lg font-medium text-gray-900">Add New Bucket List Item</h3>
        <button type="button" onclick="closeAddNewModal()" class="text-gray-400 hover:text-gray-500">
          <span class="text-2xl">&times;</span>
        </button>
      </div>
      <form id="addItemForm" action="/create_item" method="POST" class="px-6 py-4 space-y-5">
        <input type="hidden" name="priv" id="privInput" value="False" />
        
        <div>
          <label for="titleInput" class="block font-medium">Title<span class="text-red-500">*</span></label>
          <input type="text" name="title" id="titleInput" required class="w-full border rounded px-3 py-2" />
        </div>
        
        <div>
          <label for="contactInput" class="block font-medium">Contact <span class="text-gray-400">(optional)</span> </label>
          <input type="text" name="contact" id="contactInput" required class="w-full border rounded px-3 py-2" />
        </div>
        
        <div>
          <label for="areaInput" class="block font-medium">Location<span class="text-red-500">*</span></label>
          <input type="text" name="area" id="areaInput" required class="w-full border rounded px-3 py-2" />
          <input type="hidden" name="lat" id="latInput">
          <input type="hidden" name="lng" id="lngInput">
        </div>
        
        <div>
          <label for="descripInput" class="block font-medium">Description<span class="text-red-500">*</span></label>
          <input type="text" name="descrip" id="descripInput" required class="w-full border rounded px-3 py-2" />
        </div>
  
        <div>
          <label for="categoryInput" class="block font-medium text-gray-700 mb-1">Category<span class="text-red-500">*</span></label>
          <select type="text" name="category" id="categoryInput" required class="w-full border rounded px-3 py-2" >
            <option value="">Select a category</option>
            <option value="food">Food üçΩÔ∏è</option>
            <option value="adventure">Adventure üèîÔ∏è</option>
            <option value="music">Music üé∏</option>
            <option value="sports">Sports üèÄ</option>
            <option value="events">Events üéâ</option>
            <option value="academic">Academic üìö</option>
            <option value="other">Other ‚ú®</option>
          </select>
        </div>
        
        <div class="flex items-center justify-between pt-2">
          <label class="font-medium text-gray-700">Event Privacy:</label>
          <div class="flex items-center">
            <span class="mr-2 text-sm text-gray-600">Public</span>
            <div class="relative inline-block w-12 mr-2 align-middle select-none">
              <input type="checkbox" id="privToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4
              appearance-none cursor-pointer transition-transform duration-200 ease-in-out"/>
              <label for="privToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
            </div>
          </div>
          <span class="text-sm text-orange-600 font-medium">Private</span>
        </div>
        <div class="text-right pt-4">
          <button type="submit" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600">
            <i class="fas fa-plus mr-2"></i>Create New Item
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <style>
    .toggle-checkbox:checked {
      right: 0;
      border-color: #f97316;
      transform: translateX(100%);
    }
    .toggle-checkbox:checked + .toggle-label {
      background-color: #f97316;
    }
  </style>
  
  <!--Configured with help-->
  <script>
    function openAddNewModal() {
      const modal = document.getElementById("addNewModal");
      const content = document.getElementById("modContent");
      document.getElementById("addNewModal").classList.remove("hidden");
      document.body.classList.add("overflow-hidden");
      setTimeout(() => {
        content.classList.remove("scale-95", "opacity-0");
        content.classList.add("scale-100", "opacity-100");
      }, 10);
    }

    function closeAddNewModal() {
      document.getElementById("addNewModal").classList.add("hidden");
      document.body.classList.remove("overflow-hidden");
    }

    // Handle clicks outside the modal to close it
    document.addEventListener("click", function(event) {
      const modal = document.getElementById("addNewModal");
      if (event.target === modal) {
        closeAddNewModal();
      }
    });

    document.getElementById("privToggle").addEventListener("change", function() {
      const isChecked = this.checked;
      const privInput = document.querySelector('input[name="priv"]');
      privInput.value = isChecked ? "True" : "False";
    });

    // Google Places Autocomplete for location field
    function initAddItemAutocomplete() {
      const input = document.getElementById("areaInput");
      const autocomplete = new google.maps.places.Autocomplete(input);

      autocomplete.addListener("place_changed", () => {
        const place = autocomplete.getPlace();
        if (!place.geometry || !place.geometry.location) return;

        document.getElementById("latInput").value = place.geometry.location.lat();
        document.getElementById("lngInput").value = place.geometry.location.lng();
      });
    }

    // Initialize Google Places when Maps API loads
    if (typeof google !== 'undefined' && google.maps) {
      initAddItemAutocomplete();
    } else {
      // It will be initialized by the callback in the script tag
    }
</script>
  
  <script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}&libraries=places&callback=initAddItemAutocomplete" async defer></script>